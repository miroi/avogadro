## Simple buildup configuration file for circleci.com
##
## See https://circleci.com/docs/getting-started
##     https://circleci.com/docs/configuration
##     https://circleci.com/docs/config-sample
##
## OpenMPI 64-bit installation: 
##     https://gist.github.com/rbast/81760961c5a8199e561a
##     http://diracprogram.org/doc/release-12/installation/int64/mpi.html
##

# list of branches to build
general:
    branches:
        only:
            - travis

test:
    pre:
# check our environment variables
        - echo "Number of processors on this machine is `cat /proc/cpuinfo | grep processor | wc -l` "
# take care of proper library
        - sudo apt-get update
        - sudo apt-get autoclean
        - sudo apt-get clean
        - sudo apt-get install gcc g++ gfortran make cmake 
        - sudo apt-get install libqt4-dev qt4-dev-tools pyqt4-dev-tools 
        - sudo apt-get install libqt4-opengl-dev libeigen3-dev libwxgtk3.0-dev
        - sudo apt-get install openbabel libopenbabel-dev libboost-python-dev python-sip-dev

# show info about available processors
        - lscpu
    override:
# configure, build optimized code with OpenBLAS and run the test
        - mkdir build
        - cmake ..
# build with make, build with ctest makes impossible to submit more test commands into one entry on dashboard
        - make -j4 { pwd: build }
# ldd - show dirac.x dependencies
       # - ldd bin/example: { pwd: build }
# run tests
       # - bin/example:  { pwd: build }
